\NeedsTeXFormat{LaTeX2e}
\ProvidesPackage{jmbarrett}[2020/04/06 jmbarrett]

\author{Jordan Mitchell Barrett}

%  Load required packages
\RequirePackage{amsmath}
\RequirePackage{amssymb}
\RequirePackage{amsthm}
\RequirePackage{contour}
\RequirePackage[linktoc=all,hidelinks]{hyperref}
\RequirePackage{ulem}
\RequirePackage{url}
\RequirePackage{xcolor}

\@ifclassloaded{beamer}{}{\RequirePackage{enumitem}}



%%  COMMENT STUFF OUT
\newcommand{\comment}[1]{}


%%  ARXIV
\newcommand{\arxiv}[1]{\href{https://arxiv.org/abs/#1}{\texttt{arXiv:#1}}}



%%  BIBLATEX

\RequirePackage[
	backend=biber,%citestyle=alphabetic,%maxalphanames=1,
	style=alphabetic,
	%cite
%	citestyle=phys,
	doi=false,isbn=false,
	date=year,
]{biblatex}
\DeclareNolabel{\nolabel{\regexp{[\p{Z}\p{P}\p{S}\p{C}]+}}}


%  Bibliography style
\DeclareFieldFormat*{title}{\textit{#1}}
\DeclareFieldFormat*{journaltitle}{#1}
\DeclareFieldFormat*{booktitle}{\textit{#1}}

%  Remove "and" in author list
\DefineBibliographyExtras{english}{%
  \renewcommand*{\finalnamedelim}{\addcomma\addspace}%
}

%  Write "Masters thesis" instead of "MA thesis"
\DefineBibliographyStrings{english}{%
  mathesis = {Master's thesis},
}

%  Appearance of "In:" in bib entries
\renewbibmacro{in:}{%
  \ifboolexpr{%
     test {\ifentrytype{article}}%
%     or
%     test {\ifentrytype{inproceedings}}%
  }{ %blank
  }{%
%    \iffieldundef{pages}{%
        %blank
%    }{%
        \MakeLowercase{\printfield{pages}}%
        \clearfield{pages}%
%    }%
    \addspace%
    \printtext{\bibstring{in}}%
    \addcolon\addspace%
%
    % Put editor names before book title
    \ifnameundef{bookauthor}%
    {\ifnameundef{editor}%
       {\ifnameundef{translator}{}{%
       \printnames{translator}%
        \setunit{\addcomma\space}%
        \usebibmacro{translator+othersstrg}%
        \clearname{translator}%
           }%
       }%
       {\printnames{editor}%
%        \setunit{\addcomma\space}%
        \addspace\printtext[parens]{%
        \usebibmacro{editor+othersstrg}%
        }%
        \clearname{editor}}}%
    {\ifnamesequal{author}{bookauthor}%
       {}%
       {\printnames{bookauthor}%
        \clearname{bookauthor}}}%
  \newunit\newblock%
%
    %\intitlepunct}
%    \clearfield{pages}%
    }%
}

%  Remove extra page numbers in "in*" styles
%\DeclareFieldFormat[inbook,incollection,inproceedings]{pages}{}

%  Get volume/issue to look like "31(2)"
\renewbibmacro*{volume+number+eid}{%
  \printfield{volume}%
%  \setunit*{\adddot}% DELETED
%  \setunit*{\addnbspace}% NEW (optional); there's also \addnbthinspace
  \printfield{number}}%
%  \setunit{\addcomma\space}%
%  \printfield{eid}}
\DeclareFieldFormat[article]{volume}{\textbf{#1}}
\DeclareFieldFormat[article]{number}{\textbf{\mkbibparens{#1}}}
\DeclareFieldFormat[book]{number}{\textbf{#1}}

%  Correct volume/number for proceedings
\DeclareFieldFormat[inproceedings]{volume}{}
\DeclareFieldFormat[inproceedings]{volumes}{}

\renewbibmacro*{series+number}{%
    \ifboolexpr{%
        test {\ifentrytype{inproceedings}}%
        and%
        (not test {\iffieldundef{volume}})%
    }{%
        \printfield{series}%
        \addspace%
        \textbf{\thefield{volume}}%
        \newunit%
    }{%
        \printfield{series}%
        \setunit*{\addspace}%
        \printfield{number}%
        \newunit%
    }%
}

% Remove url for books, theses
%\DeclareFieldFormat[book,thesis]{url}{}

% For articles: print url only if no journal
\DeclareFieldFormat[article]{url}{
    \iffieldundef{journaltitle}{%\textsc{url}\addcolon\addspace
    \url{#1}{}}}
% For books, proceedings, etc: print url only if no publisher
\DeclareFieldFormat[book,inbook,incollection,inproceedings,proceedings]{url}{
    \iflistundef{publisher}{%NOPUBLISHER}{YESPUBLISHER}}%\textsc{url}\addcolon\addspace
    \url{#1}{}}}
    
% Remove "(visited at xxxx)"
\DeclareFieldFormat{urldate}{}

% For articles: remove publisher info
\DeclareFieldFormat[article]{publisher}{}

% let "publisher" and "location" change place
\renewbibmacro*{publisher+location+date}{%
  \printlist{publisher}%
  \setunit*{\addcomma\space}%
  \printlist{location}%
  \setunit*{\addcomma\space}%
  \usebibmacro{date}%
  \newunit}


%  Fix order in articles so it goes:
%     journal, pages, year, url
\renewbibmacro*{issue+date}{}%     % Remove date

\renewbibmacro*{note+pages}{%       % Add date after pages
  \printfield{note}%
  \setunit{\bibpagespunct}%
  \printfield{pages}%
  \setunit{\addcomma\addspace}%
  \usebibmacro{date}%
  \newunit}
  
  
% Proper capitalisation of titles
\DeclareFieldFormat{titlecase}{\MakeTitleCase{#1}}

\newrobustcmd{\MakeTitleCase}[1]{%
  \ifthenelse{%
  % These are the ones to keep in title case
  %
  \ifcurrentfield{journaltitle}%
  %
  }{#1}{\MakeSentenceCase{#1}}}


%  Remove pagetotal for books
\DeclareFieldFormat{pagetotal}{}

%  Write arXiv ID / url correctly
%\comment{
\renewbibmacro*{doi+eprint+url}{%
    %\setunit{
    \adddot\addspace%}%
    \iffieldundef{eprint}{%
        \printfield{url}%
    }{%
        \iffieldequalstr{eprinttype}{arxiv}{%
            \printtext{arXiv}%
            \addcolon\addspace%
            \href{https://arxiv.org/abs/\thefield{eprint}}{\texttt{\thefield{eprint}}}%
            %\arxiv{\thefield{eprint}}%
        }{%
            \iffieldequalstr{eprinttype}{hdl}{%
                \textsc{hdl}%
                \addcolon\addspace%
                \href{https://hdl.handle.net/\thefield{eprint}}{\texttt{\thefield{eprint}}}%
            }{%
                \printfield{url}%
            }%
        }%
    }%
}
%}

% For theses: fix formatting of uni + location
\renewbibmacro*{institution+location+date}{%
    \printlist{institution}%
    \setunit*{\addcomma\addspace}%
    \printlist{location}%
    \setunit*{\addcomma\addspace}%
    \usebibmacro{date}%
    \newunit}





%%  THEOREMS

\theoremstyle{definition}

%  Beamer doesn't like these ones
%\@ifclassloaded{beamer}{}{
	\newtheorem{theorem}{Theorem}[section]
	\newtheorem{lemma}[theorem]{Lemma}
	\newtheorem{example}[theorem]{Example}
	\newtheorem{definition}[theorem]{Definition}
	\newtheorem{problem}[theorem]{Problem}
	\newtheorem{corollary}[theorem]{Corollary}
%}

\newtheorem{proposition}[theorem]{Proposition}
\newtheorem{thmclaim}{Claim}[theorem]	% Claims inside proof of thm
\newtheorem{notation}[theorem]{Notation}
\newtheorem{remark}[theorem]{Remark}
%\newtheorem*{remark}[theorem]{Remark}
\newtheorem{axiom}[theorem]{Axiom}
\newtheorem{axioms}[theorem]{Axioms}
\newtheorem{question}[theorem]{Question}
\newtheorem{thesis}[theorem]{Thesis}
\newtheorem{process}[theorem]{Process}
\newtheorem{conjecture}[theorem]{Conjecture}


%  Removes brackets () from theorem optional argument
%\makeatletter
\def\thmhead@plain#1#2#3{%
	\thmname{#1}\thmnumber{\@ifnotempty{#1}{ }\@upn{#2}}%
	\thmnote{ {\the\thm@notefont#3}}}
\let\thmhead\thmhead@plain
%\makeatother



%  List formatting - beamer doesn't like these
\@ifclassloaded{beamer}{}{
	\setlist[enumerate,1]{label={(\roman*)}}
	\setlist[enumerate,2]{label={(\alph*)}}
%	\setlist[description]{font=\rmfamily\mdseries}
}

\newcommand{\tfae}[2]{\item[\rmfamily\mdseries(#1)$\Rightarrow$(#2):]}
\newcommand{\ifff}{\item[($\Rightarrow$)]}
\newcommand{\iffb}{\item[($\Leftarrow$)]}


%  CUSTOM MATH COMMANDS

%  Standard sets
\newcommand{\N}{\mathbb{N}}			% Natural numbers
\newcommand{\Z}{\mathbb{Z}}			% Integers
\newcommand{\Q}{\mathbb{Q}}			% Rational numbers
\newcommand{\R}{\mathbb{R}}			% Real numbers
%\newcommand{\C}{\mathbb{C}}		% Complex numbers
\newcommand{\UI}{{[0,1]}}			% Unit interval
\newcommand{\UIQ}{{[0,1]_\Q}}		% Rational unit interval

%  Curly letters
\newcommand{\A}{\mathcal{A}}
\newcommand{\B}{\mathcal{B}}
\newcommand{\C}{\mathcal{C}}
\newcommand{\D}{\mathcal{D}}
\newcommand{\F}{\mathcal{F}}
\newcommand{\Hh}{\mathcal{H}}
\newcommand{\I}{\mathcal{I}}
\newcommand{\J}{\mathcal{J}}
\newcommand{\K}{\mathcal{K}}
\newcommand{\Ll}{\mathcal{L}}		% Curly "L" for language
\newcommand{\M}{\mathcal{M}}
\newcommand{\Nn}{\mathcal{N}}
\newcommand{\Rr}{\mathcal{R}}
\newcommand{\Ss}{\mathcal{S}}
\newcommand{\T}{\mathcal{T}}		% Curly "T" for theory
\newcommand{\U}{\mathcal{U}}		% Curly "U" for ultrafilter
\newcommand{\V}{\mathcal{V}}

%  General logic / model theory
\newcommand{\proves}{\vdash}			% Turnstile for "proves"
\newcommand{\nproves}{\nvdash}			% Turnstile for "proves"
\renewcommand{\models}{\vDash}			% Double turnstile "models"
\newcommand{\nmodels}{\nvDash}			% Double turnstile "models"
\newcommand{\liff}{\leftrightarrow}		% <-> symbol in formulae

%  Axioms / axiomatic systems
\newcommand{\ZF}{\mathsf{ZF}}			% Zermelo-Fraenkel set theory
\newcommand{\AC}{\mathsf{AC}}			% Axiom of choice
\newcommand{\ZFC}{\mathsf{ZFC}}			% ZF + AC
\newcommand{\RCAstar}{{\mathsf{RCA}^*_0}}
\newcommand{\RCA}{\mathsf{RCA}_0}		% Recursive comprehension
\newcommand{\WKL}{\mathsf{WKL}_0}		% Weak Konig's lemma
\newcommand{\ACA}{\mathsf{ACA}_0}		% Arithmetical comprehension
\newcommand{\ATR}{\mathsf{ATR}_0}		% Arithmetic transfinite recursion
\newcommand{\PiCA}{\Pi^1_1\text{-}\mathsf{CA}_0}	% Pi-1-1 comprehension
\newcommand{\PA}{\mathsf{PA}}			% Peano arithmetic

%  Nonstandard analysis
\newcommand{\h}{{}^*}				% Nonstandard extension
\newcommand{\kh}[1]{{}^{#1*}}		% k-iterated hyperextension
\newcommand{\hh}{{}^\bullet}		% ω-iterated hyperextension

%  Computability
\newcommand{\Rc}{{\mathbb{R}_\text{c}}}		% Computable reals
\newcommand{\UIc}{{[0,1]_\text{c}}}			% Computable unit interval
\newcommand{\CS}{{2^\omega}}					% Cantor space 2^ω
\newcommand{\CSf}{{2^{<\omega}}}				% Cantor space 2^<ω
\newcommand{\CSc}{{2^\omega_\text{c}}}		% Computable Cantor space
\newcommand{\BS}{{\omega^\omega}}				% Baire space ω^ω
\newcommand{\BSf}{{\omega^{<\omega}}}			% Baire space 2^<ω
\newcommand{\BSc}{{\omega^\omega_\text{c}}}	% Computable Baire space
\newcommand{\pair}[2]{\langle {#1}, {#2} \rangle}		% Pairing function
\newcommand{\substr}[2]{{{#1}{\upharpoonright}_{#2}}}	% Substring

%  Category theory
\newcommand{\CC}{\mathbf{C}}		% Boldface "C" for category
\newcommand{\DD}{\mathbf{D}}		% Boldface "D" for category
\newcommand{\Set}{\mathbf{Set}}		% Category of sets
\newcommand{\Grp}{\mathbf{Grp}}		% Category of groups
\newcommand{\Ring}{\mathbf{Ring}}	% Category of rings
\newcommand{\Top}{\mathbf{Top}}		% Category of topological spaces
\newcommand{\Gph}{\mathbf{Gph}}		% Category of (simple) graphs
\newcommand{\Ord}{\mathbf{Ord}}		% Category of ordinals
\newcommand{\Ab}{\mathbf{Ab}}		% Category of groups

%  Set theory
\newcommand{\cc}{\mathfrak{c}}			% Cardinality of the continuum
\newcommand{\en}{{\varepsilon_0}}		% The ordinal epsilon-0
\DeclareMathOperator{\cf}{cf}			% Cofinality

%  Useful operators
\DeclareMathOperator{\dom}{dom}				% Domain
\DeclareMathOperator{\id}{id}				% Identity function
\DeclareMathOperator{\im}{im}               % Image of fn
\DeclareMathOperator{\image}{image}         % Image of fn
\DeclareMathOperator{\Pow}{\mathcal{P}}		% Power set
\DeclareMathOperator{\range}{range}			% Range
\DeclareMathOperator{\spn}{span}			% Linear span
\DeclareMathOperator{\supp}{supp}			% Support

%  Misc
\newcommand{\abs}[1]{{\left\lvert #1 \right\rvert}}		% Absolute value
\newcommand{\Abs}[1]{{\left\lVert #1 \right\rVert}}		% Vector norm
\newcommand{\floor}[1]{{\left\lfloor #1 \right\rfloor}}		% Floor function
\newcommand{\ceil}[1]{{\left\lceil #1 \right\rceil}}		% Ceiling function
\newcommand{\ang}[1]{{\left\langle #1 \right\rangle}}	% Angle brackets
\newcommand{\ct}{{}^\frown}								% String concatenation
\newcommand{\defeq}{
	\mathrel{\mathrel{\mathop:}\mkern-1.2mu=}}			% := symbol
\newcommand{\eqdef}{
	\mathrel{=\mathrel{\mathop:}\mkern-1.2mu}}			% =: symbol
\newcommand{\eps}{\varepsilon}
\DeclareMathOperator{\dif}{d\!}							% Differential d
\newcommand{\q}[2]{{#1 / {#2}}}							% Quotient
\newcommand{\restr}[2]{{{#1}{\mid}_{#2}}}	% Restriction



%  BEAMER STUFF

%  frame* environment - makes the footnote rule play nice with "pause"
\newenvironment{frame*}[2]{\bgroup
	\let\oldfootnoterule\footnoterule
	\def\footnoterule{\only<#2->\oldfootnoterule}
	\begin{frame}{#1}}{\end{frame}
	\egroup}

%  \fitem - use instead of \item to fill in space on slide
\newcommand{\fitem}{\vspace{\fill}\item\vspace{\fill}}



%  UNDERLINE

%  Define nice underline - https://alexwlchan.net/2017/10/latex-underlines/
\renewcommand{\ULdepth}{1.8pt}
\contourlength{0.8pt}
\newcommand{\ul}[1]{%
	\uline{\phantom{#1}}%
	\llap{\contour{white}{#1}}%
}

%  \ulink{url}{text}  gives underlined links
\newcommand{\ulink}[2]{\href{#1}{\ul{#2}}}